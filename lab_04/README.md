# Алгоритм RSA

Алгоритм ассимитричного шифрования на основе открытого ключа.

* **открытый ключ** - для шифрования (известен, зашифровать может кто угодно);
* **закрытый ключ** - для расшифровки (этот ключ секретен, расшифровать может только тот, кто им обладает).

## Вычисление ключей
1. Берутся два простых больших числа *p*, *q*.
1. `n = p * q` - длина алфавита (зашифрованного)
1. `fi(n) = (p - 1)(q - 1)` - функция Эйлера
1. *e* - открытый ключ: взаимно простое с функцией Эйлера *fi*
1. *d* - секретный ключ: `(e * d) mod fi(n) = 1`.

> Взаимно простое = не имеет ни одного общего делителя, кроме 1.

> *`d > 0`*. Находится по расширенному алгоритму Евклида (в отрицательную степень не возводить!)


## Шифрование ( *c* )
Каждая единица текста возводится в степень е по модулю n.

`c = (m^e) mod n`

## Расшифровка ( *m'* )
Зашифрованный текст возводится в степень d по модулю n.

`m' = (c^d) mod n`

## Используемые алгоритмы

### Решето Эратосфена

> опционально: можно заменить на алгоритм Миллера-Рабина (вероятностный)

* На выходе: массив простых чисел.
* Поочередно вычеркиваются числа, кратные i, не включая сам i. 
* i от 2 до t.
* t задается в качестве верхней границы самостоятельно.

### Быстрое возведение в степень

> опционально: можно использовать *встроенную* функцию, но знать, как работает, **обязательно**!

`r = a^k mod n` - результат работы

1. `r = 1`
1. `? k > 0`
    * `? k - нечетное: r = (r * a) mod n`
    * `k = k / 2`
    * `a = (a * a) mod n`

### Расширенный алгоритма Евклида *vs* алгоритм Евклида
"Обычный" алгоритм Евклида находит наибольший общий делитель двух чисел *a* и *b*.

Расширенный алгоритм Евклида находит помимо НОД также коэффициенты *x* и *y* такие, что:

`ax + by = НОД(a, b) = 1`.
